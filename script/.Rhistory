labs(x="Probability", y = "Potential loss", fill="Name" ) +
scale_fill_discrete(guide = "legend")
p
require(ggplot2)
#single
probability = c(2)
hazard = c(5)
name = c("Operational risk")
#group
#probability = c(4,3,2,5,3)
#hazard = c(3,4.5,5,1,4)
#name = c("Market risk","Strategic asset privatization risk","Operational risk,"Free riding risk","External risk")
data <- data.frame(probability,hazard,name)
p <- ggplot(data, aes(x=probability, y=hazard, fill=name)) +
geom_point(colour = 4, size = 3) +
coord_cartesian(ylim=c(0,5), xlim=c(0,5)) +
labs(x="Probability", y = "Potential loss", fill="Name" ) +
scale_fill_discrete(guide = "legend")
p
require(googlesheets)
g <- gs_title("Risk scatter")
data <- gs_read(g)
length(data)
length(data$Name)
require(ggplot2)
require(googlesheets)
g <- gs_title("Risk scatter")
data <- gs_read(g)
l <- length(data$Name)
p <- ggplot(data, aes(x=Probability, y=Hazard, fill=Name)) +
geom_point(colour = l:2, size = 3) +
coord_cartesian(ylim=c(0,5), xlim=c(0,5)) +
labs(x="Probability", y = "Potential loss", fill="Name" ) +
scale_fill_discrete(guide = "legend")
p
View(data)
require(ggplot2)
require(googlesheets)
g <- gs_title("Risk scatter")
data <- gs_read(g)
l <- length(data$Name)
p <- ggplot(data, aes(x=Probability, y=Hazard, fill=Name)) +
geom_point(colour = Color, size = 3) +
coord_cartesian(ylim=c(0,5), xlim=c(0,5)) +
labs(x="Probability", y = "Potential loss", fill="Name" ) +
scale_fill_discrete(guide = "legend")
p
p <- ggplot(data, aes(x=Probability, y=Hazard, fill=Name)) +
geom_point(colour = data$Color, size = 3) +
coord_cartesian(ylim=c(0,5), xlim=c(0,5)) +
labs(x="Probability", y = "Potential loss", fill="Name" ) +
scale_fill_discrete(guide = "legend")
p
p <- ggplot(data, aes(x=Probability, y=Hazard, fill=Name)) +
geom_point(colour = 0.1:0.9, size = 3) +
coord_cartesian(ylim=c(0,5), xlim=c(0,5)) +
labs(x="Probability", y = "Potential loss", fill="Name" ) +
scale_fill_discrete(guide = "legend")
p
p <- ggplot(data, aes(x=Probability, y=Hazard, fill=Name)) +
geom_point(colour = 2.1:2.9, size = 3) +
coord_cartesian(ylim=c(0,5), xlim=c(0,5)) +
labs(x="Probability", y = "Potential loss", fill="Name" ) +
scale_fill_discrete(guide = "legend")
p
p <- ggplot(data, aes(x=Probability, y=Hazard, fill=Name)) +
geom_point(colour = 20:90, size = 3) +
coord_cartesian(ylim=c(0,5), xlim=c(0,5)) +
labs(x="Probability", y = "Potential loss", fill="Name" ) +
scale_fill_discrete(guide = "legend")
p
p <- ggplot(data, aes(x=Probability, y=Hazard, fill=Name)) +
geom_point(colour = 20:29, size = 3) +
coord_cartesian(ylim=c(0,5), xlim=c(0,5)) +
labs(x="Probability", y = "Potential loss", fill="Name" ) +
scale_fill_discrete(guide = "legend")
p
p <- ggplot(data, aes(x=Probability, y=Hazard, fill=Name)) +
geom_point(colour = 21:29, size = 3) +
coord_cartesian(ylim=c(0,5), xlim=c(0,5)) +
labs(x="Probability", y = "Potential loss", fill="Name" ) +
scale_fill_discrete(guide = "legend")
p
require(ggplot2)
require(googlesheets)
g <- gs_title("Risk scatter")
data <- gs_read(g)
p <- ggplot(data, aes(x=Probability, y=Hazard, fill=Name)) +
geom_point(colour = data$Color, size = 3) +
coord_cartesian(ylim=c(0,5), xlim=c(0,5)) +
labs(x="Probability", y = "Potential loss", fill="Name" ) +
scale_fill_discrete(guide = "legend")
p
require(ggplot2)
require(googlesheets)
g <- gs_title("Risk scatter")
data <- gs_read(g)
p <- ggplot(data, aes(x=Probability, y=Hazard, fill=Name)) +
geom_point(colour = data$Color, size = 3) +
coord_cartesian(ylim=c(0,5), xlim=c(0,5)) +
labs(x="Probability", y = "Potential loss", fill="Name" ) +
scale_fill_discrete(guide = "legend")
p
View(data)
g <- gs_title("Risk scatter")
data <- gs_read(g)
View(data)
p <- ggplot(data, aes(x=Probability, y=Hazard, fill=Name)) +
geom_point(colour = data$Color, size = 3) +
coord_cartesian(ylim=c(0,5), xlim=c(0,5)) +
labs(x="Probability", y = "Potential loss", fill="Name" ) +
scale_fill_discrete(guide = "legend")
p
g <- gs_title("Risk scatter")
data <- gs_read(g)
l <- length(data$Name)
p <- ggplot(data, aes(x=Probability, y=Hazard, fill=Name)) +
geom_point(colour = data$Color, size = 3) +
coord_cartesian(ylim=c(0,5), xlim=c(0,5)) +
labs(x="Probability", y = "Potential loss", fill="Name" ) +
scale_fill_discrete(guide = "legend")
p
g <- gs_title("Risk scatter")
data <- gs_read(g)
View(data)
p <- ggplot(data, aes(x=Probability, y=Hazard, fill=Name)) +
geom_point(colour = data$Color, size = 3) +
coord_cartesian(ylim=c(0,5), xlim=c(0,5)) +
labs(x="Probability", y = "Potential loss", fill="Name" ) +
scale_fill_discrete(guide = "legend")
p
install.packages("wesanderson")
require(wesanderson)
p <- ggplot(data, aes(x=Probability, y=Hazard, fill=Name)) +
geom_point(size = 3) +
scale_fill_manual(values=wes_palette(n=3, name="GrandBudapest"))
coord_cartesian(ylim=c(0,5), xlim=c(0,5)) +
labs(x="Probability", y = "Potential loss", fill="Name" ) +
scale_fill_discrete(guide = "legend")
p
p <- ggplot(data, aes(x=Probability, y=Hazard, fill=Name)) +
geom_point(size = 3) +
scale_fill_manual(values=wes_palette(n=9, name="GrandBudapest"))
p <- ggplot(data, aes(x=Probability, y=Hazard, fill=Name)) +
geom_point(size = 3) +
scale_fill_manual(values=wes_palette(n=9, name="GrandBudapest"))
coord_cartesian(ylim=c(0,5), xlim=c(0,5)) +
labs(x="Probability", y = "Potential loss", fill="Name" ) +
scale_fill_discrete(guide = "legend")
p <- ggplot(data, aes(x=Probability, y=Hazard, fill=Name)) +
geom_point(size = 3) +
scale_fill_manual(values=wes_palette(n=9, name="GrandBudapest")) +
coord_cartesian(ylim=c(0,5), xlim=c(0,5)) +
labs(x="Probability", y = "Potential loss", fill="Name" ) +
scale_fill_discrete(guide = "legend")
p
wes_palette(n=9, name="GrandBudapest")
p <- ggplot(data, aes(x=Probability, y=Hazard, fill=Name, color=qsec)) +
geom_point(size = 3) +
scale_color_gradient(low="blue", high="red") +
coord_cartesian(ylim=c(0,5), xlim=c(0,5)) +
labs(x="Probability", y = "Potential loss", fill="Name" ) +
scale_fill_discrete(guide = "legend")
p
g <- gs_title("Risk scatter")
data <- gs_read(g)
p <- ggplot(data, aes(x=Probability, y=Hazard, fill=Name, color=Color)) +
geom_point(size = 3) +
scale_color_gradient(low="blue", high="red") +
coord_cartesian(ylim=c(0,5), xlim=c(0,5)) +
labs(x="Probability", y = "Potential loss", fill="Name" ) +
scale_fill_discrete(guide = "legend")
p
p <- ggplot(data, aes(x=Probability, y=Hazard, fill=Name, color=Color)) +
geom_point(size = 3) +
scale_color_gradient2(midpoint=mid, low="blue", mid="white",
high="red", space ="Lab" ) +
coord_cartesian(ylim=c(0,5), xlim=c(0,5)) +
labs(x="Probability", y = "Potential loss", fill="Name" ) +
scale_fill_discrete(guide = "legend")
p
p <- ggplot(data, aes(x=Probability, y=Hazard, fill=Name, color=Color)) +
geom_point(size = 3) +
scale_color_gradient2(low="blue", mid="white",
high="red", space ="Lab" ) +
coord_cartesian(ylim=c(0,5), xlim=c(0,5)) +
labs(x="Probability", y = "Potential loss", fill="Name" ) +
scale_fill_discrete(guide = "legend")
p
p <- ggplot(data, aes(x=Probability, y=Hazard, fill=Name, color=Color)) +
geom_point(size = 3) +
scale_color_gradient2(low="blue", mid="white",
high="red", space ="Lab" ) +
coord_cartesian(ylim=c(0,5), xlim=c(0,5)) +
labs(x="Probability", y = "Potential loss", fill="Name" ) +
p
p <- ggplot(data, aes(x=Probability, y=Hazard, fill=Name, color=Color)) +
geom_point(size = 3) +
scale_color_gradient2(low="blue", mid="white",
high="red", space ="Lab" ) +
coord_cartesian(ylim=c(0,5), xlim=c(0,5)) +
labs(x="Probability", y = "Potential loss")
p
p <- ggplot(data, aes(x=Probability, y=Hazard, color=Color)) +
geom_point(size = 3) +
scale_color_gradient2(low="blue", mid="white",
high="red", space ="Lab" ) +
coord_cartesian(ylim=c(0,5), xlim=c(0,5)) +
labs(x="Probability", y = "Potential loss")
p
p <- ggplot(data, aes(x=Probability, y=Hazard, color=Color)) +
geom_point(size = 3) +
scale_color_gradient2(low="blue", mid="white",
high="red", space ="Lab" ) +
coord_cartesian(ylim=c(0,5), xlim=c(0,5)) +
labs(x="Probability", y = "Potential loss", color="Sum")
p
p <- ggplot(data, aes(x=Probability, y=Hazard, color=Color)) +
geom_point(size = 3) +
scale_color_gradient2(low="blue", mid="white",
high="red", space ="Lab" ) +
coord_cartesian(ylim=c(0,5), xlim=c(0,5)) +
labs(x="Probability", y = "Potential loss", color="Riskiness")
p
p <- ggplot(data, aes(x=Probability, y=Hazard, color=Color)) +
geom_point(size = 3) +
scale_color_gradient2(low="blue", mid="white",
high="red", space ="Lab" ) +
coord_cartesian(ylim=c(0,5), xlim=c(0,5)) +
labs(x="Probability", y = "Potential loss", color="Riskiness") +
geom_text(label=Names)
p <- ggplot(data, aes(x=Probability, y=Hazard, color=Color)) +
geom_point(size = 3) +
scale_color_gradient2(low="blue", mid="white",
high="red", space ="Lab" ) +
coord_cartesian(ylim=c(0,5), xlim=c(0,5)) +
labs(x="Probability", y = "Potential loss", color="Riskiness") +
geom_text(label=data$Names)
View(data)
p <- ggplot(data, aes(x=Probability, y=Hazard, color=Color)) +
geom_point(size = 3) +
scale_color_gradient2(low="blue", mid="white",
high="red", space ="Lab" ) +
coord_cartesian(ylim=c(0,5), xlim=c(0,5)) +
labs(x="Probability", y = "Potential loss", color="Riskiness") +
geom_text(label=data$Name)
p
p <- ggplot(data, aes(x=Probability, y=Hazard, color=Color)) +
geom_point(size = 3) +
scale_color_gradient2(low="blue", mid="white",
high="red", space ="Lab" ) +
coord_cartesian(ylim=c(0,5), xlim=c(0,5)) +
labs(x="Probability", y = "Potential loss", color="Riskiness") +
geom_text(label=data$Name, color = "black")
p
p <- ggplot(data, aes(x=Probability, y=Hazard, color=Color)) +
geom_point(size = 3) +
scale_color_gradient2(low="blue", mid="white",
high="red", space ="Lab" ) +
coord_cartesian(ylim=c(0,5), xlim=c(0,5)) +
labs(x="Probability", y = "Potential loss", color="Riskiness") +
geom_label(label=data$Name, color = "black")
p
install.packages(ggrepel)
install.packages("ggrepel")
p <- ggplot(data, aes(x=Probability, y=Hazard, color=Color)) +
geom_point(size = 3) +
scale_color_gradient2(low="blue", mid="white",
high="red", space ="Lab" ) +
coord_cartesian(ylim=c(0,5), xlim=c(0,5)) +
labs(x="Probability", y = "Potential loss", color="Riskiness") +
geom_text_repel(aes(label=data$Name, size = 3.5))
require(ggrepel)
p <- ggplot(data, aes(x=Probability, y=Hazard, color=Color)) +
geom_point(size = 3) +
scale_color_gradient2(low="blue", mid="white",
high="red", space ="Lab" ) +
coord_cartesian(ylim=c(0,5), xlim=c(0,5)) +
labs(x="Probability", y = "Potential loss", color="Riskiness") +
geom_text_repel(aes(label=data$Name, size = 3.5))
p
p <- ggplot(data, aes(x=Probability, y=Hazard, color=Color)) +
geom_point(size = 3) +
scale_color_gradient2(low="blue", mid="white",
high="red", space ="Lab" ) +
coord_cartesian(ylim=c(0,5), xlim=c(0,5)) +
labs(x="Probability", y = "Potential loss", color="Riskiness") +
geom_text_repel(aes(label=data$Name, color = "black"))
p
p <- ggplot(data, aes(x=Probability, y=Hazard, color=Color)) +
geom_point(size = 3) +
scale_color_gradient2(low="blue", mid="white",
high="red", space ="Lab" ) +
coord_cartesian(ylim=c(0,5), xlim=c(0,5)) +
labs(x="Probability", y = "Potential loss", color="Riskiness") +
geom_text_repel(aes(label=data$Name, color = "black"))
p
p <- ggplot(data, aes(x=Probability, y=Hazard, color=Color)) +
geom_point(size = 3) +
scale_color_gradient2(low="blue", mid="white",
high="red", space ="Lab" ) +
coord_cartesian(ylim=c(0,5), xlim=c(0,5)) +
labs(x="Probability", y = "Potential loss", color="Riskiness") +
geom_text_repel(aes(label=data$Name), color = "black")
p
l <- lapply(data, autoplot)
dati[,1]
data[,1]
data[1,]
sp <- function(d,i)
{
ggplot(d[i,], aes(x=Probability, y=Hazard, color=2)) + geom_point(size = 3)
}
l <- lapply(data, sp)
l <- lapply(data, 1, sp)
l <- lapply(data, 2, sp)
sp <- function(d)
{
ggplot(d[1,], aes(x=Probability, y=Hazard, color=2)) + geom_point(size = 3)
}
data <- gs_read(g)
l <- lapply(data, sp)
for (i in 1:length(data$Name)){
l[i] <- ggplot(data, aes(x=Probability, y=Hazard, color=2, fill=Name)) +
geom_point(size = 3) +
labs(x="Probability", y = "Potential loss", fill="Name")
}
View(l)
l[1]
l[[1]]
l <- list()
for (i in 1:length(data$Name)){
p <- ggplot(data, aes(x=Probability, y=Hazard, color=2, fill=Name)) +
geom_point(size = 3) +
labs(x="Probability", y = "Potential loss", fill="Name")
l[[i]] <- p
}
l[[1]]
l <- list()
for (i in 1:length(data$Name)){
p <- ggplot(data, aes(x=Probability[i], y=Hazard[i],fill=Name[i]), color = 2) +
geom_point(size = 3) +
labs(x="Probability", y = "Potential loss", fill="Name")
l[[i]] <- p
}
l[[1]]
l <- list()
i <- 0
for (i in 1:length(data$Name)){
p <- ggplot(data, aes(x=Probability[i], y=Hazard[i],fill=Name[i]), color = 2) +
geom_point(size = 3) +
labs(x="Probability", y = "Potential loss", fill="Name") +
coord_cartesian(ylim=c(0,5), xlim=c(0,5))
l[[i]] <- p
}
l[1]
l <- list()
i <- 0
for (i in 1:length(data$Name)){
p <- ggplot(data, aes(x=Probability[i], y=Hazard[i],fill=Name[i]), colour = 2) +
geom_point(size = 3) +
labs(x="Probability", y = "Potential loss", fill="Name") +
coord_cartesian(ylim=c(0,5), xlim=c(0,5))
l[[i]] <- p
}
l[[1]]
l[[1:9]]
l[[9]]
l[[5]]
l <- list()
i <- 1
for (i in length(data$Name)){
p <- ggplot(data, aes(x=Probability[i], y=Hazard[i],fill=Name[i]), colour = 2) +
geom_point(size = 3) +
labs(x="Probability", y = "Potential loss", fill="Name") +
coord_cartesian(ylim=c(0,5), xlim=c(0,5))
l[[i]] <- p
}
l[[5]]
l[[1]]
l <- list()
i <- 1
for (i in length(data$Name)){
print(i)
p <- ggplot(data, aes(x=Probability[i], y=Hazard[i],fill=Name[i]), colour = 2) +
geom_point(size = 3) +
labs(x="Probability", y = "Potential loss", fill="Name") +
coord_cartesian(ylim=c(0,5), xlim=c(0,5))
l[[i]] <- p
}
i <- 1
for (i in 1:length(data$Name)){
print(i)
p <- ggplot(data, aes(x=Probability[i], y=Hazard[i],fill=Name[i]), colour = 2) +
geom_point(size = 3) +
labs(x="Probability", y = "Potential loss", fill="Name") +
coord_cartesian(ylim=c(0,5), xlim=c(0,5))
l[[i]] <- p
}
l[[5]]
data$Probability[i]
data$Probability[3]
ggplot(data, aes(x=Probability[i], y=Hazard[i],fill=Name[i]), colour = "red") +
geom_point(size = 3) +
labs(x="Probability", y = "Potential loss", fill="Name") +
coord_cartesian(ylim=c(0,5), xlim=c(0,5))
p <- ggplot(data, aes(x=Probability[i], y=Hazard[i],fill=Name[i], colour = "red")) +
geom_point(size = 3) +
labs(x="Probability", y = "Potential loss", fill="Name") +
coord_cartesian(ylim=c(0,5), xlim=c(0,5))
p <- ggplot(data, aes(x=Probability[i], y=Hazard[i],fill=Name[i])) +
geom_point(size = 3, colour = "red") +
labs(x="Probability", y = "Potential loss", fill="Name") +
coord_cartesian(ylim=c(0,5), xlim=c(0,5))
p <- ggplot(data, aes(x=Probability[i], y=Hazard[i]), fill=Name[i]) +
geom_point(size = 3, colour = "red") +
labs(x="Probability", y = "Potential loss", fill="Name") +
coord_cartesian(ylim=c(0,5), xlim=c(0,5))
p <- ggplot(data, aes(x=Probability[i], y=Hazard[i]), fill="ciao") +
geom_point(size = 3, colour = "red") +
labs(x="Probability", y = "Potential loss", fill="Name") +
coord_cartesian(ylim=c(0,5), xlim=c(0,5))
p
ggplot(data, aes(x=Probability[i], y=Hazard[i]), fill=Name[i]) +
geom_point(size = 3, colour = "red") +
labs(x="Probability", y = "Potential loss", fill="Name") +
coord_cartesian(ylim=c(0,5), xlim=c(0,5))
ggplot(data, aes(x=Probability[i], y=Hazard[i], fill=Name[i])) +
geom_point(size = 3, colour = "red") +
labs(x="Probability", y = "Potential loss", fill="Name") +
coord_cartesian(ylim=c(0,5), xlim=c(0,5))
for (i in 1:length(data$Name)){
print(i)
p <- ggplot(data, aes(x=Probability[i], y=Hazard[i], fill=Name[i])) +
geom_point(size = 3, colour = "red") +
labs(x="Probability", y = "Potential loss", fill="Name") +
coord_cartesian(ylim=c(0,5), xlim=c(0,5))
l[[i]] <<- p
}
l <- list()
i <- 1
for (i in 1:length(data$Name)){
print(i)
p <- ggplot(data, aes(x=Probability[i], y=Hazard[i], fill=Name[i])) +
geom_point(size = 3, colour = "red") +
labs(x="Probability", y = "Potential loss", fill="Name") +
coord_cartesian(ylim=c(0,5), xlim=c(0,5))
l[[i]] <<- p
}
#single plot creation
l <- list()
l[[i]] <<- p
l[i] <<- p
l <- list()
i <- 1
for (i in 1:length(data$Name)){
print(i)
p <- ggplot(data, aes(x=Probability[i], y=Hazard[i], fill=Name[i])) +
geom_point(size = 3, colour = "red") +
labs(x="Probability", y = "Potential loss", fill="Name") +
coord_cartesian(ylim=c(0,5), xlim=c(0,5))
l[[i]] = p
}
l[[5]]
l <- list()
i <- 1
for (i in 1:length(data$Name))
local({
i <- i
p <- ggplot(data, aes(x=Probability[i], y=Hazard[i], fill=Name[i])) +
geom_point(size = 3, colour = "red") +
labs(x="Probability", y = "Potential loss", fill="Name") +
coord_cartesian(ylim=c(0,5), xlim=c(0,5))
print(i)
print(p)
l[[i]] <<- p
})
l[[1]]
l[[2]]
l[[1]]
l[[2]]
l[[3]]
l[[5]]
l[[6]]
l[[7]]
library(forecast)
library(tseries)
library(neuralnet)
library(ggplot2)
library(ggpubr)
#Start from the  first sixty data points
stockfull <- read.table("stock.csv", dec = ",", sep = ";", header = 1)
setwd("~/Documents/DynamicEcon/script")
#Start from the  first sixty data points
stockfull <- read.table("stock.csv", dec = ",", sep = ";", header = 1)
ts.plot(stockfull[,1])
ts.plot(stockfull[,"AAPL"])
train <- ts(stockfull[,"AAPL"])
autoplot(train)
Acf(train)
Pacf(train)
Acf(train)
Pacf(train)
arima<-auto.arima(train)
plot(arima)
autoplot(arima)
library(ggfortify)
autoplot(arima)
error <- arima$fitted - train
autoplot(error)
Acf(error)
Pacf(error)
